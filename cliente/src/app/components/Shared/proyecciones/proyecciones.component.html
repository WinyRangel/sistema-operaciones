<div class="container py-3">
  <header>
    <h1><i class="fas fa-file-contract"></i> Proyecciones de entregas</h1>
    <p>Monitoreo y seguimiento de entrega de creditos seg√∫n las proyecciones</p>
  </header>

  <div class="card">
    <div class="card-header">
      <h2><i class="fas fa-table"></i>Ciclo de credito</h2>
      <div>
        <span class="status-badge status-pending">Pendiente: 12</span>
        <span class="status-badge status-completed">Completado: 8</span>
        <span class="status-badge status-delayed">Retrasado: 4</span>
      </div>
    </div>

    <div class="upload-section">
      <div class="upload-box">
        <i class="fas fa-cloud-upload-alt"></i>
        <h3>Seleccione un archivo xslx para cargar</h3>
        <label class="file-input">
          <i class="fas fa-file-csv"></i> Seleccionar archivo
           <input id="file-input" type="file" accept=".xlsx" (change)="onFileChange($event)" hidden />
        </label>
        <p class="file-info">El archivo debe contener las columnas: No., ASESOR, Grupo/Individual, Fecha Entrega
          Ope., Fecha Entrega</p>
      </div>
    </div>

     <!-- tabs -->
    <ul class="nav nav-tabs mb-3" *ngIf="sheetNames.length">
      <li class="nav-item" *ngFor="let name of sheetNames">
        <a class="nav-link" [class.active]="name === currentSheet" (click)="switchSheet(name)">{{ name }}</a>
      </li>
    </ul>

    <!-- table editable -->
    <div class="table-container" *ngIf="currentSheet">
      <table class="table table-bordered table-striped">
        <thead>
          <th>Asesor</th>
          <th>Grupo/Individual</th>
          <th>Fecha Entrega Ope.</th>
          <th>Fecha de envio de operativo</th>
        </thead>
        <tbody>
          <tr *ngFor="let row of getRows(currentSheet); let i = index">
            <td *ngFor="let col of getColumnCount(currentSheet)">
              <input *ngIf="isCheckboxColumn(currentSheet, col)" type="checkbox" class="form-check-input"
                [(ngModel)]="sheetsData[currentSheet][i + 1][col]">
              <input *ngIf="!isCheckboxColumn(currentSheet, col)"
                [type]="isDateColumn(currentSheet, col) ? 'date' : 'text'" class="form-control"
                [(ngModel)]="sheetsData[currentSheet][i + 1][col]">
            </td>
          </tr>
        </tbody>
      </table>
    </div>
<div class="actions">
  <button class="btn btn-primary" (click)="saveChanges()">
    <i class="fas fa-save"></i> Guardar Cambios
  </button>
  <!-- <button class="btn btn-primary"><i class="fas fa-save"></i> Guardar Cambios</button> -->
  <button class="btn btn-success"><i class="fas fa-file-export"></i> Exportar xslx</button>
  <button class="btn btn-secondary"><i class="fas fa-sync-alt"></i> Actualizar</button>
</div>
</div>
</div>


<!-- <div class="container py-3"> -->
  <!-- upload section -->
  <!-- <div class="upload-section text-center mb-4">
    <label class="btn btn-outline-primary">
      <i class="fas fa-file-excel"></i> Seleccionar archivo
      <input id="file-input" type="file" accept=".xlsx" (change)="onFileChange($event)" hidden />
    </label>
  </div> -->

  <!-- tabs -->
  <!-- <ul class="nav nav-tabs mb-3" *ngIf="sheetNames.length">
    <li class="nav-item" *ngFor="let name of sheetNames">
      <a class="nav-link" [class.active]="name === currentSheet" (click)="switchSheet(name)">{{ name }}</a>
    </li>
  </ul> -->

  <!-- table editable -->
  <!-- <div class="table-container" *ngIf="currentSheet">
    <table class="table table-bordered table-striped">
      <thead>
        <th>Asesor</th>
        <th>Grupo/Individual</th>
        <th>Fecha Entrega Ope.</th>
        <th>Fecha de envio de operativo</th>
      </thead>
      <tbody>
        <tr *ngFor="let row of getRows(currentSheet); let i = index">
          <td *ngFor="let col of getColumnCount(currentSheet)">
            <input *ngIf="isCheckboxColumn(currentSheet, col)" type="checkbox" class="form-check-input"
              [(ngModel)]="sheetsData[currentSheet][i + 1][col]">
            <input *ngIf="!isCheckboxColumn(currentSheet, col)"
              [type]="isDateColumn(currentSheet, col) ? 'date' : 'text'" class="form-control"
              [(ngModel)]="sheetsData[currentSheet][i + 1][col]">
          </td>
        </tr>
      </tbody>
    </table>
  </div> -->

  <!-- actions -->
  <!-- <div class="text-end mt-2">
    <button class="btn btn-primary me-2" (click)="saveChanges()" [disabled]="!sheetNames.length">
      Guardar Cambios
    </button>
    <button class="btn btn-success me-2" (click)="exportExcel()" [disabled]="!sheetNames.length">
      Exportar .xlsx
    </button>
    <button class="btn btn-secondary" (click)="refreshSheet()" [disabled]="!sheetNames.length">
      Actualizar
    </button>
  </div>
</div> -->