<div class="container-fluid py-4">
    <div class="row justify-content-center">
        <div class="col-xxl-10 col-xl-12">
            <div class="card shadow-lg rounded-4 border-0 bg-light">
                <div class="card-header bg-primary text-white rounded-top-3 py-4">
                    <h3 class="text-center mb-0 fw-bold display-6">Cumplimiento de Agenda y Objetivos</h3>
                </div>

                <div class="card-body p-4 mb-3">
                    <!-- Selector de Coordinador -->
                    <nav class="nav nav-pills nav-justified flex-column flex-md-row mb-4">
                        <a *ngFor="let coord of coordinadores" class="nav-link"
                            [class.active]="coord === coordinadorSeleccionado" (click)="seleccionarCoordinador(coord)"
                            href="javascript:void(0);">
                            {{ coord }}
                        </a>
                    </nav>

                    <!-- Fila para selector y objetivo -->
                    <div class="row align-items-center g-3 mb-3">
                        <!-- Selector de semana -->
                        <div class="col-md-4">
                            <select class="form-select form-select-sm shadow-sm" [(ngModel)]="semanaSeleccionada"
                                (change)="seleccionarSemana(semanaSeleccionada)">
                                <option value="" disabled selected>Seleccionar semana</option>
                                <option *ngFor="let semana of semanas" [value]="semana">{{ semana }}</option>
                            </select>
                        </div>

                        <!-- Objetivo -->
                        <div class="col-md-8 mb">
                            <p class="mb-0"><strong>Objetivo:</strong> {{ objetivo }}</p>
                        </div>
                    </div>

                    <!-- Tabla de resultados -->
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <th>Semana</th>
                                    <th>Códigos detectados</th>
                                    <th>Agendados</th>
                                    <th>Reportados</th>
                                    <th>% Cumplimiento</th>
                                </tr>
                            </thead>
                            <tbody>
                                <ng-container *ngFor="let fila of dataTabla">
                                    <tr *ngIf="fila.semana === semanaSeleccionada">
                                        <td>{{ fila.semana }}</td>
                                        <td>{{ fila.codigos.join(', ') }}</td>
                                        <td>{{ fila.agendados }}</td>
                                        <td>{{ fila.reportados }}</td>
                                        <td>{{ fila.porcentaje }}%</td>
                                    </tr>
                                </ng-container>
                            </tbody>
                            <tbody *ngIf="!dataTabla.length">
                                <tr>
                                    <td colspan="5" class="text-center">No hay datos disponibles.</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Tabla de detalles de actividades cumplidas -->
                    <div *ngIf="detalleActividades.length" class="mt-4">
                        <h5 class="mb-3">Detalle de Actividades</h5>
                        <!-- <div class="table-responsive">
                            <table class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th>Código</th>
                                        <th>Actividad Agendada</th>
                                        <th>Actividad Reportada</th>
                                        <th>Cumplimiento</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let actividad of detalleActividades">
                                        <td>{{ actividad.codigo }}</td>
                                        <td>{{ actividad.actividadAgendada }}</td>
                                        <td>{{ actividad.actividadReportada }}</td>
                                        <td>
                                            <span [class.text-success]="actividad.cumplida"
                                                [class.text-danger]="!actividad.cumplida" class="fw-bold">
                                                {{ actividad.cumplida ? 'Sí' : 'No' }}
                                            </span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div> -->
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered fixed-table">
                                <!-- Definimos anchos relativos o absolutos -->
                                <colgroup>
                                    <col style="width: 10%;">
                                    <col style="width: 30%;">
                                    <col style="width: 50%;">
                                    <col style="width: 10%;">
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Código</th>
                                        <th>Actividad Agendada</th>
                                        <th>Actividad Reportada</th>
                                        <th>Cumplimiento</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let actividad of detalleActividades">
                                        <td class="cell-wrap">{{ actividad.codigo }}</td>
                                        <td class="cell-wrap">{{ actividad.actividadAgendada }}</td>
                                        <td class="cell-wrap">{{ actividad.actividadReportada }}</td>
                                        <td class="cell-wrap">
                                            <span [class.text-success]="actividad.cumplida"
                                                [class.text-danger]="!actividad.cumplida" class="fw-bold">
                                                {{ actividad.cumplida ? 'Sí' : 'No' }}
                                            </span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>